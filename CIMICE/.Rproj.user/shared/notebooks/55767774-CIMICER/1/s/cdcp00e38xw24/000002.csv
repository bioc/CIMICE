"0",""
"0","upWeights <<- seq(-1, -1, length.out = length(E(g)))"
"0",""
"0","computeUPW = function(edge) {"
"0","    "
"0","    if (upWeights[edge] != -1) return(upWeights[edge])"
"0","    "
"0","    source = as_ids(tail_of(g,edge))"
"0","    destination = as_ids(head_of(g,edge))"
"0","    "
"0","    D = no.of.children[source]"
"0","    P = freqs[source]"
"0","    "
"0","    W <- 0"
"0","    if(length(which(A[,source] >= 1)) != 0){"
"0","        edges.entering.in.source <- lapply( as.list(which(A[,source] >= 1)), function (x) c(x,source) )"
"0","        edges.entering.in.source <- get.edge.ids(g, unlist(edges.entering.in.source)) "
"0","        "
"0","        W <- sum( sapply( edges.entering.in.source , function (x) computeUPW(x) ) )"
"0","    }"
"0","    "
"0","    upWeights[edge] <<-  (1/D) * (P+W)"
"0","    return(upWeights[edge])"
"0","}"
"0",""
"0","upWeights <- sapply( 1:length(E(g)), function(x) computeUPW(x) )"
"0","upWeights"
"1"," [1]"
"1"," 0.15000000"
"1"," 0.15000000"
"1"," 0.25000000"
"1"," 0.06666667"
"1"," 0.06666667"
"1"," 0.06666667"
"1"," 0.16666667"
"1"," 0.31666667"
"1"," 0.00000000"
"1"," 0.00000000"
"1","
"
